<?php

namespace Mermaid;

/**
 * @license GNU GPL v2+
 * @since 2.4.0
 *
 * @author howlowck
 */
class MermaidConfigExtractor
{
	// TODO: This should eventually be autogenerated by programmatically inspecting the config json set by mermaid.js
	// Get default config with 
	// console.log(mermaid.mermaidAPI.getConfig())
	// Then cleaned up in python to join recursive keys with .
	// Manually added FILTER_VALIDATE_BOOLEAN to each bool field
	private $configMap = [
		'flowchart.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'flowchart.titleTopMargin' => null,
		'flowchart.diagramPadding' => null,
		'flowchart.htmlLabels' => FILTER_VALIDATE_BOOLEAN,
		'flowchart.nodeSpacing' => null,
		'flowchart.rankSpacing' => null,
		'flowchart.curve' => null,
		'flowchart.padding' => null,
		'flowchart.defaultRenderer' => null,
		'flowchart.wrappingWidth' => null,
		'sequence.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'sequence.hideUnusedParticipants' => FILTER_VALIDATE_BOOLEAN,
		'sequence.activationWidth' => null,
		'sequence.diagramMarginX' => null,
		'sequence.diagramMarginY' => null,
		'sequence.actorMargin' => null,
		'sequence.width' => null,
		'sequence.height' => null,
		'sequence.boxMargin' => null,
		'sequence.boxTextMargin' => null,
		'sequence.noteMargin' => null,
		'sequence.messageMargin' => null,
		'sequence.messageAlign' => null,
		'sequence.mirrorActors' => FILTER_VALIDATE_BOOLEAN,
		'sequence.forceMenus' => FILTER_VALIDATE_BOOLEAN,
		'sequence.bottomMarginAdj' => null,
		'sequence.rightAngles' => FILTER_VALIDATE_BOOLEAN,
		'sequence.showSequenceNumbers' => FILTER_VALIDATE_BOOLEAN,
		'sequence.actorFontSize' => null,
		'sequence.actorFontFamily' => null,
		'sequence.actorFontWeight' => null,
		'sequence.noteFontSize' => null,
		'sequence.noteFontFamily' => null,
		'sequence.noteFontWeight' => null,
		'sequence.noteAlign' => null,
		'sequence.messageFontSize' => null,
		'sequence.messageFontFamily' => null,
		'sequence.messageFontWeight' => null,
		'sequence.wrap' => FILTER_VALIDATE_BOOLEAN,
		'sequence.wrapPadding' => null,
		'sequence.labelBoxWidth' => null,
		'sequence.labelBoxHeight' => null,
		'gantt.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'gantt.titleTopMargin' => null,
		'gantt.barHeight' => null,
		'gantt.barGap' => null,
		'gantt.topPadding' => null,
		'gantt.rightPadding' => null,
		'gantt.leftPadding' => null,
		'gantt.gridLineStartPadding' => null,
		'gantt.fontSize' => null,
		'gantt.sectionFontSize' => null,
		'gantt.numberSectionStyles' => null,
		'gantt.axisFormat' => null,
		'gantt.topAxis' => FILTER_VALIDATE_BOOLEAN,
		'gantt.displayMode' => null,
		'gantt.weekday' => null,
		'journey.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'journey.diagramMarginX' => null,
		'journey.diagramMarginY' => null,
		'journey.leftMargin' => null,
		'journey.width' => null,
		'journey.height' => null,
		'journey.boxMargin' => null,
		'journey.boxTextMargin' => null,
		'journey.noteMargin' => null,
		'journey.messageMargin' => null,
		'journey.messageAlign' => null,
		'journey.bottomMarginAdj' => null,
		'journey.rightAngles' => FILTER_VALIDATE_BOOLEAN,
		'journey.taskFontSize' => null,
		'journey.taskFontFamily' => null,
		'journey.taskMargin' => null,
		'journey.activationWidth' => null,
		'journey.textPlacement' => null,
		'journey.actorColours' => null,
		'journey.sectionFills' => null,
		'journey.sectionColours' => null,
		'class.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'class.titleTopMargin' => null,
		'class.arrowMarkerAbsolute' => FILTER_VALIDATE_BOOLEAN,
		'class.dividerMargin' => null,
		'class.padding' => null,
		'class.textHeight' => null,
		'class.defaultRenderer' => null,
		'class.htmlLabels' => FILTER_VALIDATE_BOOLEAN,
		'state.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'state.titleTopMargin' => null,
		'state.dividerMargin' => null,
		'state.sizeUnit' => null,
		'state.padding' => null,
		'state.textHeight' => null,
		'state.titleShift' => null,
		'state.noteMargin' => null,
		'state.forkWidth' => null,
		'state.forkHeight' => null,
		'state.miniPadding' => null,
		'state.fontSizeFactor' => null,
		'state.fontSize' => null,
		'state.labelHeight' => null,
		'state.edgeLengthFactor' => null,
		'state.compositTitleSize' => null,
		'state.radius' => null,
		'state.defaultRenderer' => null,
		'er.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'er.titleTopMargin' => null,
		'er.diagramPadding' => null,
		'er.layoutDirection' => null,
		'er.minEntityWidth' => null,
		'er.minEntityHeight' => null,
		'er.entityPadding' => null,
		'er.stroke' => null,
		'er.fill' => null,
		'er.fontSize' => null,
		'pie.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'pie.textPosition' => null,
		'pie.useWidth' => null,
		'quadrantChart.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'quadrantChart.chartWidth' => null,
		'quadrantChart.chartHeight' => null,
		'quadrantChart.titleFontSize' => null,
		'quadrantChart.titlePadding' => null,
		'quadrantChart.quadrantPadding' => null,
		'quadrantChart.xAxisLabelPadding' => null,
		'quadrantChart.yAxisLabelPadding' => null,
		'quadrantChart.xAxisLabelFontSize' => null,
		'quadrantChart.yAxisLabelFontSize' => null,
		'quadrantChart.quadrantLabelFontSize' => null,
		'quadrantChart.quadrantTextTopPadding' => null,
		'quadrantChart.pointTextPadding' => null,
		'quadrantChart.pointLabelFontSize' => null,
		'quadrantChart.pointRadius' => null,
		'quadrantChart.xAxisPosition' => null,
		'quadrantChart.yAxisPosition' => null,
		'quadrantChart.quadrantInternalBorderStrokeWidth' => null,
		'quadrantChart.quadrantExternalBorderStrokeWidth' => null,
		'xyChart.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.width' => null,
		'xyChart.height' => null,
		'xyChart.titleFontSize' => null,
		'xyChart.titlePadding' => null,
		'xyChart.showTitle' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.xAxis.showLabel' => null,
		'xyChart.xAxis.labelFontSize' => null,
		'xyChart.xAxis.labelPadding' => null,
		'xyChart.xAxis.showTitle' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.xAxis.titleFontSize' => null,
		'xyChart.xAxis.titlePadding' => null,
		'xyChart.xAxis.showTick' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.xAxis.tickLength' => null,
		'xyChart.xAxis.tickWidth' => null,
		'xyChart.xAxis.showAxisLine' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.xAxis.axisLineWidth' => null,
		'xyChart.yAxis.showLabel' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.yAxis.labelFontSize' => null,
		'xyChart.yAxis.labelPadding' => null,
		'xyChart.yAxis.showTitle' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.yAxis.titleFontSize' => null,
		'xyChart.yAxis.titlePadding' => null,
		'xyChart.yAxis.showTick' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.yAxis.tickLength' => null,
		'xyChart.yAxis.tickWidth' => null,
		'xyChart.yAxis.showAxisLine' => FILTER_VALIDATE_BOOLEAN,
		'xyChart.yAxis.axisLineWidth' => null,
		'xyChart.chartOrientation' => null,
		'xyChart.plotReservedSpacePercent' => null,
		'requirement.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'requirement.rect_fill' => null,
		'requirement.text_color' => null,
		'requirement.rect_border_size' => null,
		'requirement.rect_border_color' => null,
		'requirement.rect_min_width' => null,
		'requirement.rect_min_height' => null,
		'requirement.fontSize' => null,
		'requirement.rect_padding' => null,
		'requirement.line_height' => null,
		'mindmap.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'mindmap.padding' => null,
		'mindmap.maxNodeWidth' => null,
		'timeline.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'timeline.diagramMarginX' => null,
		'timeline.diagramMarginY' => null,
		'timeline.leftMargin' => null,
		'timeline.width' => null,
		'timeline.height' => null,
		'timeline.boxMargin' => null,
		'timeline.boxTextMargin' => null,
		'timeline.noteMargin' => null,
		'timeline.messageMargin' => null,
		'timeline.messageAlign' => null,
		'timeline.bottomMarginAdj' => null,
		'timeline.rightAngles' => FILTER_VALIDATE_BOOLEAN,
		'timeline.taskFontSize' => null,
		'timeline.taskFontFamily' => null,
		'timeline.taskMargin' => null,
		'timeline.activationWidth' => null,
		'timeline.textPlacement' => null,
		'timeline.actorColours' => null,
		'timeline.sectionFills' => null,
		'timeline.sectionColours' => null,
		'timeline.disableMulticolor' => FILTER_VALIDATE_BOOLEAN,
		'gitGraph.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'gitGraph.titleTopMargin' => null,
		'gitGraph.diagramPadding' => null,
		'gitGraph.nodeLabel.width' => null,
		'gitGraph.nodeLabel.height' => null,
		'gitGraph.nodeLabel.x' => null,
		'gitGraph.nodeLabel.y' => null,
		'gitGraph.mainBranchName' => null,
		'gitGraph.mainBranchOrder' => null,
		'gitGraph.showCommitLabel' => FILTER_VALIDATE_BOOLEAN,
		'gitGraph.showBranches' => FILTER_VALIDATE_BOOLEAN,
		'gitGraph.rotateCommitLabel' => FILTER_VALIDATE_BOOLEAN,
		'gitGraph.arrowMarkerAbsolute' => FILTER_VALIDATE_BOOLEAN,
		'c4.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'c4.diagramMarginX' => null,
		'c4.diagramMarginY' => null,
		'c4.c4ShapeMargin' => null,
		'c4.c4ShapePadding' => null,
		'c4.width' => null,
		'c4.height' => null,
		'c4.boxMargin' => null,
		'c4.c4ShapeInRow' => null,
		'c4.nextLinePaddingX' => null,
		'c4.c4BoundaryInRow' => null,
		'c4.personFontSize' => null,
		'c4.personFontFamily' => null,
		'c4.personFontWeight' => null,
		'c4.external_personFontSize' => null,
		'c4.external_personFontFamily' => null,
		'c4.external_personFontWeight' => null,
		'c4.systemFontSize' => null,
		'c4.systemFontFamily' => null,
		'c4.systemFontWeight' => null,
		'c4.external_systemFontSize' => null,
		'c4.external_systemFontFamily' => null,
		'c4.external_systemFontWeight' => null,
		'c4.system_dbFontSize' => null,
		'c4.system_dbFontFamily' => null,
		'c4.system_dbFontWeight' => null,
		'c4.external_system_dbFontSize' => null,
		'c4.external_system_dbFontFamily' => null,
		'c4.external_system_dbFontWeight' => null,
		'c4.system_queueFontSize' => null,
		'c4.system_queueFontFamily' => null,
		'c4.system_queueFontWeight' => null,
		'c4.external_system_queueFontSize' => null,
		'c4.external_system_queueFontFamily' => null,
		'c4.external_system_queueFontWeight' => null,
		'c4.boundaryFontSize' => null,
		'c4.boundaryFontFamily' => null,
		'c4.boundaryFontWeight' => null,
		'c4.messageFontSize' => null,
		'c4.messageFontFamily' => null,
		'c4.messageFontWeight' => null,
		'c4.containerFontSize' => null,
		'c4.containerFontFamily' => null,
		'c4.containerFontWeight' => null,
		'c4.external_containerFontSize' => null,
		'c4.external_containerFontFamily' => null,
		'c4.external_containerFontWeight' => null,
		'c4.container_dbFontSize' => null,
		'c4.container_dbFontFamily' => null,
		'c4.container_dbFontWeight' => null,
		'c4.external_container_dbFontSize' => null,
		'c4.external_container_dbFontFamily' => null,
		'c4.external_container_dbFontWeight' => null,
		'c4.container_queueFontSize' => null,
		'c4.container_queueFontFamily' => null,
		'c4.container_queueFontWeight' => null,
		'c4.external_container_queueFontSize' => null,
		'c4.external_container_queueFontFamily' => null,
		'c4.external_container_queueFontWeight' => null,
		'c4.componentFontSize' => null,
		'c4.componentFontFamily' => null,
		'c4.componentFontWeight' => null,
		'c4.external_componentFontSize' => null,
		'c4.external_componentFontFamily' => null,
		'c4.external_componentFontWeight' => null,
		'c4.component_dbFontSize' => null,
		'c4.component_dbFontFamily' => null,
		'c4.component_dbFontWeight' => null,
		'c4.external_component_dbFontSize' => null,
		'c4.external_component_dbFontFamily' => null,
		'c4.external_component_dbFontWeight' => null,
		'c4.component_queueFontSize' => null,
		'c4.component_queueFontFamily' => null,
		'c4.component_queueFontWeight' => null,
		'c4.external_component_queueFontSize' => null,
		'c4.external_component_queueFontFamily' => null,
		'c4.external_component_queueFontWeight' => null,
		'c4.wrap' => FILTER_VALIDATE_BOOLEAN,
		'c4.wrapPadding' => null,
		'c4.person_bg_color' => null,
		'c4.person_border_color' => null,
		'c4.external_person_bg_color' => null,
		'c4.external_person_border_color' => null,
		'c4.system_bg_color' => null,
		'c4.system_border_color' => null,
		'c4.system_db_bg_color' => null,
		'c4.system_db_border_color' => null,
		'c4.system_queue_bg_color' => null,
		'c4.system_queue_border_color' => null,
		'c4.external_system_bg_color' => null,
		'c4.external_system_border_color' => null,
		'c4.external_system_db_bg_color' => null,
		'c4.external_system_db_border_color' => null,
		'c4.external_system_queue_bg_color' => null,
		'c4.external_system_queue_border_color' => null,
		'c4.container_bg_color' => null,
		'c4.container_border_color' => null,
		'c4.container_db_bg_color' => null,
		'c4.container_db_border_color' => null,
		'c4.container_queue_bg_color' => null,
		'c4.container_queue_border_color' => null,
		'c4.external_container_bg_color' => null,
		'c4.external_container_border_color' => null,
		'c4.external_container_db_bg_color' => null,
		'c4.external_container_db_border_color' => null,
		'c4.external_container_queue_bg_color' => null,
		'c4.external_container_queue_border_color' => null,
		'c4.component_bg_color' => null,
		'c4.component_border_color' => null,
		'c4.component_db_bg_color' => null,
		'c4.component_db_border_color' => null,
		'c4.component_queue_bg_color' => null,
		'c4.component_queue_border_color' => null,
		'c4.external_component_bg_color' => null,
		'c4.external_component_border_color' => null,
		'c4.external_component_db_bg_color' => null,
		'c4.external_component_db_border_color' => null,
		'c4.external_component_queue_bg_color' => null,
		'c4.external_component_queue_border_color' => null,
		'sankey.useMaxWidth' => FILTER_VALIDATE_BOOLEAN,
		'sankey.width' => null,
		'sankey.height' => null,
		'sankey.linkColor' => null,
		'sankey.nodeAlignment' => null,
		'sankey.showValues' => FILTER_VALIDATE_BOOLEAN,
		'sankey.prefix' => null,
		'sankey.suffix' => null,
		'theme' => null,
		'maxTextSize' => null,
		'darkMode' => FILTER_VALIDATE_BOOLEAN,
		'fontFamily' => null,
		'logLevel' => null,
		'securityLevel' => null,
		'startOnLoad' => FILTER_VALIDATE_BOOLEAN,
		'arrowMarkerAbsolute' => FILTER_VALIDATE_BOOLEAN,
		'secure' => null,
		'deterministicIds' => FILTER_VALIDATE_BOOLEAN,
		'fontSize' => null,
		'themeVariables.background' => null,
		'themeVariables.primaryColor' => null,
		'themeVariables.secondaryColor' => null,
		'themeVariables.mainBkg' => null,
		'themeVariables.secondBkg' => null,
		'themeVariables.lineColor' => null,
		'themeVariables.border1' => null,
		'themeVariables.border2' => null,
		'themeVariables.arrowheadColor' => null,
		'themeVariables.fontFamily' => null,
		'themeVariables.fontSize' => null,
		'themeVariables.tertiaryColor' => null,
		'themeVariables.primaryBorderColor' => null,
		'themeVariables.secondaryBorderColor' => null,
		'themeVariables.tertiaryBorderColor' => null,
		'themeVariables.primaryTextColor' => null,
		'themeVariables.secondaryTextColor' => null,
		'themeVariables.tertiaryTextColor' => null,
		'themeVariables.textColor' => null,
		'themeVariables.THEME_COLOR_LIMIT' => null,
		'themeVariables.nodeBkg' => null,
		'themeVariables.nodeBorder' => null,
		'themeVariables.clusterBkg' => null,
		'themeVariables.clusterBorder' => null,
		'themeVariables.defaultLinkColor' => null,
		'themeVariables.titleColor' => null,
		'themeVariables.edgeLabelBackground' => null,
		'themeVariables.actorBorder' => null,
		'themeVariables.actorBkg' => null,
		'themeVariables.actorTextColor' => null,
		'themeVariables.actorLineColor' => null,
		'themeVariables.signalColor' => null,
		'themeVariables.signalTextColor' => null,
		'themeVariables.labelBoxBkgColor' => null,
		'themeVariables.labelBoxBorderColor' => null,
		'themeVariables.labelTextColor' => null,
		'themeVariables.loopTextColor' => null,
		'themeVariables.noteBorderColor' => null,
		'themeVariables.noteBkgColor' => null,
		'themeVariables.noteTextColor' => null,
		'themeVariables.activationBorderColor' => null,
		'themeVariables.activationBkgColor' => null,
		'themeVariables.sequenceNumberColor' => null,
		'themeVariables.sectionBkgColor' => null,
		'themeVariables.altSectionBkgColor' => null,
		'themeVariables.sectionBkgColor2' => null,
		'themeVariables.excludeBkgColor' => null,
		'themeVariables.taskBorderColor' => null,
		'themeVariables.taskBkgColor' => null,
		'themeVariables.taskTextLightColor' => null,
		'themeVariables.taskTextColor' => null,
		'themeVariables.taskTextDarkColor' => null,
		'themeVariables.taskTextOutsideColor' => null,
		'themeVariables.taskTextClickableColor' => null,
		'themeVariables.activeTaskBorderColor' => null,
		'themeVariables.activeTaskBkgColor' => null,
		'themeVariables.gridColor' => null,
		'themeVariables.doneTaskBkgColor' => null,
		'themeVariables.doneTaskBorderColor' => null,
		'themeVariables.critBorderColor' => null,
		'themeVariables.critBkgColor' => null,
		'themeVariables.todayLineColor' => null,
		'themeVariables.personBorder' => null,
		'themeVariables.personBkg' => null,
		'themeVariables.labelColor' => null,
		'themeVariables.errorBkgColor' => null,
		'themeVariables.errorTextColor' => null,
		'themeVariables.cScale0' => null,
		'themeVariables.cScale1' => null,
		'themeVariables.cScale2' => null,
		'themeVariables.cScale3' => null,
		'themeVariables.cScale4' => null,
		'themeVariables.cScale5' => null,
		'themeVariables.cScale6' => null,
		'themeVariables.cScale7' => null,
		'themeVariables.cScale8' => null,
		'themeVariables.cScale9' => null,
		'themeVariables.cScale10' => null,
		'themeVariables.cScale11' => null,
		'themeVariables.cScalePeer1' => null,
		'themeVariables.cScalePeer2' => null,
		'themeVariables.cScalePeer0' => null,
		'themeVariables.cScalePeer3' => null,
		'themeVariables.cScalePeer4' => null,
		'themeVariables.cScalePeer5' => null,
		'themeVariables.cScalePeer6' => null,
		'themeVariables.cScalePeer7' => null,
		'themeVariables.cScalePeer8' => null,
		'themeVariables.cScalePeer9' => null,
		'themeVariables.cScalePeer10' => null,
		'themeVariables.cScalePeer11' => null,
		'themeVariables.cScaleInv0' => null,
		'themeVariables.cScaleInv1' => null,
		'themeVariables.cScaleInv2' => null,
		'themeVariables.cScaleInv3' => null,
		'themeVariables.cScaleInv4' => null,
		'themeVariables.cScaleInv5' => null,
		'themeVariables.cScaleInv6' => null,
		'themeVariables.cScaleInv7' => null,
		'themeVariables.cScaleInv8' => null,
		'themeVariables.cScaleInv9' => null,
		'themeVariables.cScaleInv10' => null,
		'themeVariables.cScaleInv11' => null,
		'themeVariables.scaleLabelColor' => null,
		'themeVariables.cScaleLabel0' => null,
		'themeVariables.cScaleLabel1' => null,
		'themeVariables.cScaleLabel2' => null,
		'themeVariables.cScaleLabel3' => null,
		'themeVariables.cScaleLabel4' => null,
		'themeVariables.cScaleLabel5' => null,
		'themeVariables.cScaleLabel6' => null,
		'themeVariables.cScaleLabel7' => null,
		'themeVariables.cScaleLabel8' => null,
		'themeVariables.cScaleLabel9' => null,
		'themeVariables.cScaleLabel10' => null,
		'themeVariables.cScaleLabel11' => null,
		'themeVariables.surface0' => null,
		'themeVariables.surfacePeer0' => null,
		'themeVariables.surface1' => null,
		'themeVariables.surfacePeer1' => null,
		'themeVariables.surface2' => null,
		'themeVariables.surfacePeer2' => null,
		'themeVariables.surface3' => null,
		'themeVariables.surfacePeer3' => null,
		'themeVariables.surface4' => null,
		'themeVariables.surfacePeer4' => null,
		'themeVariables.transitionColor' => null,
		'themeVariables.transitionLabelColor' => null,
		'themeVariables.stateLabelColor' => null,
		'themeVariables.stateBkg' => null,
		'themeVariables.labelBackgroundColor' => null,
		'themeVariables.compositeBackground' => null,
		'themeVariables.altBackground' => null,
		'themeVariables.compositeTitleBackground' => null,
		'themeVariables.compositeBorder' => null,
		'themeVariables.innerEndBackground' => null,
		'themeVariables.specialStateColor' => null,
		'themeVariables.classText' => null,
		'themeVariables.fillType0' => null,
		'themeVariables.fillType1' => null,
		'themeVariables.fillType2' => null,
		'themeVariables.fillType3' => null,
		'themeVariables.fillType4' => null,
		'themeVariables.fillType5' => null,
		'themeVariables.fillType6' => null,
		'themeVariables.fillType7' => null,
		'themeVariables.pie1' => null,
		'themeVariables.pie2' => null,
		'themeVariables.pie3' => null,
		'themeVariables.pie4' => null,
		'themeVariables.pie5' => null,
		'themeVariables.pie6' => null,
		'themeVariables.pie7' => null,
		'themeVariables.pie8' => null,
		'themeVariables.pie9' => null,
		'themeVariables.pie10' => null,
		'themeVariables.pie11' => null,
		'themeVariables.pie12' => null,
		'themeVariables.pieTitleTextSize' => null,
		'themeVariables.pieTitleTextColor' => null,
		'themeVariables.pieSectionTextSize' => null,
		'themeVariables.pieSectionTextColor' => null,
		'themeVariables.pieLegendTextSize' => null,
		'themeVariables.pieLegendTextColor' => null,
		'themeVariables.pieStrokeColor' => null,
		'themeVariables.pieStrokeWidth' => null,
		'themeVariables.pieOuterStrokeWidth' => null,
		'themeVariables.pieOuterStrokeColor' => null,
		'themeVariables.pieOpacity' => null,
		'themeVariables.quadrant1Fill' => null,
		'themeVariables.quadrant2Fill' => null,
		'themeVariables.quadrant3Fill' => null,
		'themeVariables.quadrant4Fill' => null,
		'themeVariables.quadrant1TextFill' => null,
		'themeVariables.quadrant2TextFill' => null,
		'themeVariables.quadrant3TextFill' => null,
		'themeVariables.quadrant4TextFill' => null,
		'themeVariables.quadrantPointFill' => null,
		'themeVariables.quadrantPointTextFill' => null,
		'themeVariables.quadrantXAxisTextFill' => null,
		'themeVariables.quadrantYAxisTextFill' => null,
		'themeVariables.quadrantInternalBorderStrokeFill' => null,
		'themeVariables.quadrantExternalBorderStrokeFill' => null,
		'themeVariables.quadrantTitleFill' => null,
		'themeVariables.xyChart.backgroundColor' => null,
		'themeVariables.xyChart.titleColor' => null,
		'themeVariables.xyChart.xAxisTitleColor' => null,
		'themeVariables.xyChart.xAxisLabelColor' => null,
		'themeVariables.xyChart.xAxisTickColor' => null,
		'themeVariables.xyChart.xAxisLineColor' => null,
		'themeVariables.xyChart.yAxisTitleColor' => null,
		'themeVariables.xyChart.yAxisLabelColor' => null,
		'themeVariables.xyChart.yAxisTickColor' => null,
		'themeVariables.xyChart.yAxisLineColor' => null,
		'themeVariables.xyChart.plotColorPalette' => null,
		'themeVariables.requirementBackground' => null,
		'themeVariables.requirementBorderColor' => null,
		'themeVariables.requirementBorderSize' => null,
		'themeVariables.requirementTextColor' => null,
		'themeVariables.relationColor' => null,
		'themeVariables.relationLabelBackground' => null,
		'themeVariables.relationLabelColor' => null,
		'themeVariables.git0' => null,
		'themeVariables.git1' => null,
		'themeVariables.git2' => null,
		'themeVariables.git3' => null,
		'themeVariables.git4' => null,
		'themeVariables.git5' => null,
		'themeVariables.git6' => null,
		'themeVariables.git7' => null,
		'themeVariables.gitInv0' => null,
		'themeVariables.gitInv1' => null,
		'themeVariables.gitInv2' => null,
		'themeVariables.gitInv3' => null,
		'themeVariables.gitInv4' => null,
		'themeVariables.gitInv5' => null,
		'themeVariables.gitInv6' => null,
		'themeVariables.gitInv7' => null,
		'themeVariables.gitBranchLabel0' => null,
		'themeVariables.gitBranchLabel1' => null,
		'themeVariables.gitBranchLabel2' => null,
		'themeVariables.gitBranchLabel3' => null,
		'themeVariables.gitBranchLabel4' => null,
		'themeVariables.gitBranchLabel5' => null,
		'themeVariables.gitBranchLabel6' => null,
		'themeVariables.gitBranchLabel7' => null,
		'themeVariables.tagLabelColor' => null,
		'themeVariables.tagLabelBackground' => null,
		'themeVariables.tagLabelBorder' => null,
		'themeVariables.tagLabelFontSize' => null,
		'themeVariables.commitLabelColor' => null,
		'themeVariables.commitLabelBackground' => null,
		'themeVariables.commitLabelFontSize' => null,
		'themeVariables.attributeBackgroundColorOdd' => null,
		'themeVariables.attributeBackgroundColorEven' => null
	];

	/**
	 * Extracts the param array into a tuple of two arrays
	 * @param array $params
	 * @return array [$mermaidConfig, $mediawikiParam]
	 */
	public function extract(array $params)
	{
		$configMapKeys = array_keys($this->configMap);

		// Use reduce to split the param array into two arrays: [$mermaidConfig, $mediawikiParam]
		return array_reduce($params, function ($prev, $current) use ($configMapKeys) {
			// De-structures the two arrays
			list($mermaidConfig, $mwParams) = $prev;

			// if there is no "=", it belongs in mediawiki params
			if (strpos($current, '=') === false) {
				$mwParams[] = $current;
				return [$mermaidConfig, $mwParams];
			}

			// split from the first "=" into two parts, then trim both parts
			list($key, $value) = array_map('trim', explode('=', $current, 2));

			// test to see if the leftside of the "=" is in the configMap keys
			$normalizedKey = $this->keyNamingNormalizer($key);
			$inConfigMap = in_array($normalizedKey, $configMapKeys, true);

			// if not in config map, the value belongs in the mediawiki params
			if (!$inConfigMap) {
				$mwParams[] = $current;
				return [$mermaidConfig, $mwParams];
			}

			// config key is in the config map
			// check to see if there is a type associated with the key
			$normalizedValue = $value;
			$valueType = $this->configMap[$normalizedKey];
			if ($valueType !== null) {
				// normalize: 'true' => true, '1' => true, etc
				$normalizedValue = filter_var($value, $valueType, FILTER_NULL_ON_FAILURE);
			}

			// set the config with dot.notation
			$this->setWithDotNotation($mermaidConfig, $normalizedKey, $normalizedValue);
			return [$mermaidConfig, $mwParams];
		}, [[], []]);
	}

	/**
	 * Removes "config." from the dot-notationed configuration key
	 * @param string $key
	 * @return false|string
	 */
	protected function keyNamingNormalizer(string $key)
	{
		if (strpos($key, 'config.') === false) {
			return $key;
		}
		return substr($key, 7);
	}

	// Taken from Laravel's Arr::set function
	// https://github.com/laravel/framework/blob/7.x/src/Illuminate/Support/Arr.php
	/**
	 * Sets a value onto an array with keys using dot.notation, in-place
	 * @param &$array
	 * @param $key
	 * @param $value
	 * @return array|mixed
	 */
	protected function setWithDotNotation(&$array, $key, $value)
	{
		if (is_null($key)) {
			return $array = $value;
		}

		$keys = explode('.', $key);

		foreach ($keys as $i => $key) {
			if (count($keys) === 1) {
				break;
			}

			unset($keys[$i]);

			// If the key doesn't exist at this depth, we will just create an empty array
			// to hold the next value, allowing us to create the arrays to hold final
			// values at the correct depth. Then we'll keep digging into the array.
			if (!isset($array[$key]) || !is_array($array[$key])) {
				$array[$key] = [];
			}

			$array = &$array[$key];
		}

		$array[array_shift($keys)] = $value;

		return $array;
	}
}
